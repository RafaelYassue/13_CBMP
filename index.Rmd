---
title: "Do Pixel à Informação: Como a Fenotipagem de Alto Rendimento Pode Aumentar o Ganho Genético"
author:  
  - Rafael Massahiro Yassue
institute: "GDM Seeds"
date: "03 de setembro de 2025"

header-includes:
  - \usepackage{booktabs}
output:
  xaringan::moon_reader:
    lib_dir: libs
    css:
      - default
      - default-fonts 
      - animate.css
      - https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css

---
class: animate__animated, animate__fadeIn

# Summary
+ Introdução 
  + Breeding Equations
  + Novas ferramentas para ganho genético
+ Phenomics vs Genomics
+ Estudo de Caso: Integrando Genômica e Fenotipagem de Alto Rendimento na Interação Genótipo × Bactérias Promotoras de Crescimento
  - Plataforma de baixo custo para coleta de imagens em ambiente interno
  + *Shovelomics*
  + Reconstrução 3D a partir de imagens (*Structure from Motion*)
  + Câmera Multispectral 
  + Câmera Hiperspectral
  + Câmera térmica
+ Aplicações e Limitações 


---
class: animate__animated, animate__fadeIn
# Fenômica e o Ganho Genético

$$
\Delta G = \frac{\color{red}{i} \cdot \color{red}{r_a} \cdot \color{red}{\sigma_a}}{\color{red}{L}}
$$

\begin{aligned}
\Delta G & : \text{ganho genético por ciclo de seleção} \\
\color{red}{i} & : \text{intensidade de seleção} \\
\color{red}{r_a} & : \text{acurácia da seleção (melhorada com fenotipagem de alto rendimento)} \\
\color{red}{\sigma_a} & : \text{desvio-padrão genético aditivo} \\
\color{red}{L} & : \text{duração do ciclo de seleção (anos)}
\end{aligned}

--

<div style="transform: scale(0.75); transform-origin: top center;">

| **Como a Fenômica Aumenta ganho Genético** | **Efeito no Ganho Genético** |
| :---------------------------------------------- | :--------------------------- |
| Reduz o erro experimental                        | ↑ Herdabilidade → ↑ Acurácia |
| Permite medições temporais repetidas             | ↑ Precisão das estimativas   |
| Aumenta o número de plantas avaliadas            | ↑ Robustez estatística e ↑ variância genética      |
| Seleção precoce              | Correlação genética entre traits (ex.: angulação de raiz vs rusticidade) ou avaliação precoce (ex.: resistencia a doença) |

---
class: animate__animated, animate__fadeIn

# Fenômica como nova ferramenta para ganho genético

- **Aumentar a acurácia da seleção** (melhora \(r_a\) na Breeder’s Equation)

--

- **Seleção precoce** de plantas promissoras por seleção indireta e correlecao genética entre traits

--

- **Detecção precoce de doenças e estresses** antes de sintomas visíveis

--

- **Uso de traits secundários** correlacionados ao trait principal

--

- **Predição multi-fenótipo** combinando traits primários e secundários

--

- **Integração com seleção genômica** (GS + Phenomics = ↑ ganho genético)

--

- **Estudos de interação genótipo × ambiente (G×E)** em grande escala

--

- **Redução de custo por dado** em comparação à fenotipagem manual


---
# Potencial Redução de Custo

- **Investimento inicial alto** em sensores e infraestrutura

--

- **Plataformas de baixo custo** permitem coleta em larga escala

--

- **<span style="color:red; font-weight:bold;">Custo por dado cai drasticamente com o aumento da escala!</span>**

--

- **Automação** reduz custos de mão de obra 

--

- **Não possui custo de reagentes**  

---
class: animate__animated, animate__fadeIn
# Fenômica vs Genômica

<div style="transform: scale(0.75); transform-origin: top center;">

<table style="width:100%; border-collapse: collapse;">
  <thead>
    <tr>
      <th style="border: 1px solid #ddd; padding: 6px; text-align: left;">Aspecto</th>
      <th style="border: 1px solid #ddd; padding: 6px; text-align: left;">Seleção Genômica (GS)</th>
      <th style="border: 1px solid #ddd; padding: 6px; text-align: left;">Seleção Fenômica (Phenomics/HTP)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Base da predição</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Marcadores moleculares (SNPs)</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Traits fenotípicos de alta resolução</td>
    </tr>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Efeitos estimados</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Genéticos, principalmente aditivos</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Variância fenotípica; pode incluir efeitos ambientais e superestimar a acurácia</td>
    </tr>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Momento de aplicação</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Pode ser feita <b>antes da avaliação de campo</b></td>
      <td style="border: 1px solid #ddd; padding: 6px;">Necessita plantas em crescimento</td>
    </tr>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Acurácia</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Depende da população de treinamento, anos, tamanho do painel</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Alta em <b>traits fisiológicos e estruturais</b></td>
    </tr>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Custo por indivíduo</td>
      <td style="border: 1px solid #ddd; padding: 6px;"><b>Médio</b>: Laboratório + reagentes</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Alto custo inicial, <b>cai com escala</b>, sem custo de reagentes</td>
    </tr>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Velocidade do ciclo</td>
      <td style="border: 1px solid #ddd; padding: 6px;"><b>Muito rápida</b>, permite seleção antecipada</td>
      <td style="border: 1px solid #ddd; padding: 6px;"><b>Rápida</b>, mas depende do estágio fenológico</td>
    </tr>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Detecta traits secundários</td>
      <td style="border: 1px solid #ddd; padding: 6px;">Apenas se associados por modelos</td>
      <td style="border: 1px solid #ddd; padding: 6px;"><b>Sim</b>, captura sinais fisiológicos invisíveis</td>
    </tr>
    <tr>
      <td style="border: 1px solid #ddd; padding: 6px;">Integração ideal</td>
      <td colspan="2" style="border: 1px solid #ddd; padding: 6px;">
        <b>GS + Phenomics → Integração Multi-ômica:</b> Aumenta acurácia, robustez e ganho genético.
      </td>
    </tr>
  </tbody>
</table>

</div>


---
class: animate__animated, animate__fadeIn, inverse, center, middle

# Estudo de Caso: Integrando Genômica e Fenotipagem de Alto Rendimento na Interação Genótipo × Bactérias Promotoras de Crescimento

---
class: animate__animated, animate__fadeIn

# Materiais utilizados nos três projetos

+ Condições de estufa  
+ Estágio inicial de desenvolvimento do milho (seis folhas totalmente expandidas)  
+ 360 linhagens endogâmicas  
+ 13.826 SNPs  
+ Dois manejos, ambos sob condição de nitrogênio limitado:  
  - **B+** População sintética de 4 BPGP (Bactérias Promotoras de Crescimento de Plantas):  
      * *Bacillus thuringiensis* RZ2MS9  
      * *Delftia* sp. RZ4MS18  
      * *Pantoea agglomerans* 33.1  
      * *Azospirillum brasilense* Ab-v5  
  - **B-** Sem BPGP  
+ 2 repetições  
+ Total de 1.512 parcelas

---
class: animate__animated, animate__fadeIn

# Por que usar Fenotipagem de Alto Rendimento?
```{r, echo=FALSE, out.width="85%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/HTP.png")
```
---

class: animate__animated, animate__fadeIn

# Uma plataforma de fenotipagem de alto rendimento em estufa de baixo custo

```{r, echo=FALSE, out.width="75%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/Screen Shot 2022-01-05 at 7.54.52 PM.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Representação da plataforma de Fenotipagem de Alto Rendimento de baixo custo.
</p>


---
class: animate__animated, animate__fadeIn

# Coleta de Imagens Termais e Multiespectrais

```{r  , echo=FALSE, fig.show = "hold", out.width = "50%", fig.align = "default"}
knitr::include_graphics("figs/RGB_colection.gif")
knitr::include_graphics("figs/thermal_coletion.gif")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Representação da aquisição de imagens RGB (esquerda) e termais (direita) usando a plataforma de FAR (Fenotipagem de Alto Rendimento) de baixo custo.
</p>

---
class: animate__animated, animate__fadeIn

# Aquisição de Dados

```{r, echo=FALSE, out.width="90%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/HTP/fig01.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figure. Design of the greenhouse-based high-throughput phenotyping platform.
</p>

---
class: animate__animated, animate__fadeIn
# Aquisição de Imagens Hiperespectrais

```{r, echo=FALSE, out.width="90%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/fig01_da.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Resumo da aquisição e processamento de dados. A) câmera hiperespectral de bancada usada para coleta de dados; B) região de interesse da última folha expandida; C) imagem em cubo; e D) máscara da imagem.
</p>

---
class: animate__animated, animate__fadeIn

# Data processing 
```{r, echo=FALSE, out.width="75%", fig.align="center"}
knitr::include_graphics("figs/fig02.png")
```
<p style="font-family: times, serif; font-size:10pt; font-style:italic">
Figura. Resumo do processamento de imagens multiespectrais. (A) aquisição de imagens; (B) montagem do ortomosaico; (C) recorte das parcelas; (D) cobertura do dossel (CC); (E) nuvem de pontos densa; (F) a altura das plantas (PH) foi calculada com base nas diferenças entre a nuvem de pontos densa com as plantas e a nuvem de pontos densa apenas com o vaso; (G) nuvem de pontos densa após aplicação do filtro para remover o fundo; (H) nuvem de pontos densa para cada parcela; (I) reconstrução 3D da nuvem de pontos densa para obtenção do volume do dossel; e (J) f(biomassa) obtida pelo produto da altura da planta (PH) e CC.
</p>

---
class: animate__animated, animate__fadeIn

# Shovelomics 

```{r, echo=FALSE, out.width="100%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/molbreed.png")
```
---
class: animate__animated, animate__fadeIn
# Multi-phenotype Genomic prediction
```{r, echo=FALSE, out.width="70%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/mol_1.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Predição genômica usando GBLUP, GBLUP_GMS (GBLUP baseado na seleção de marcadores via GWAS) e GBLUP_MAS (GBLUP + seleção assistida por marcadores) para diversos traits e manejos.
</p>

---
class: animate__animated, animate__fadeIn
```{r, echo=FALSE, out.width="120%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/TPPJ.png")
```

---
# Crescimento de Plantas
```{r, echo=FALSE, out.width="65%", fig.align="center"}
knitr::include_graphics("figs/PG.png")
```
---
class: animate__animated, animate__fadeIn

# Correlações Fenotípicas e Genômicas
```{r, echo=FALSE, out.width="100%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/table1.png")
```

---
class: animate__animated, animate__fadeIn
```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("figs/CS.png")
```
---
class: animate__animated, animate__fadeIn
# Classificação da Inoculação com Bactérias Promotoras de Crescimento de Plantas
```{r, echo=FALSE, out.width="50%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/1-3.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Acurácia da classificação do status de inoculação (B+ e B-) usando 150 bandas hiperespectrais.
</p>

---
class: animate__animated, animate__fadeIn
# Predição Genômica, Fenômica e Multi-ômica

```{r, echo=FALSE, out.width="80%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/1-4.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Capacidade preditiva da altura de planta (PH), diâmetro do colmo (SD) e massa seca da parte aérea (SDM) utilizando modelos de predição fenômica, genômica e multi-ômica em cada condição de manejo (B+ e B-).
</p>

---
class: animate__animated, animate__fadeIn
```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("figs/PD.png")
```
---
class: animate__animated, animate__fadeIn
# Phenome-wide association studies (PheWAS)
```{r, echo=FALSE, out.width="100%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/2-6.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. PheWAS para os 10 SNPs de maior frequência em modelos para altura de planta (PH), diâmetro do colmo (SD) e massa seca da parte aérea (SDM) sob manejo B+.
</p>
---
class: animate__animated, animate__fadeIn
# Multi-phenotype GWAS
```{r, echo=FALSE, out.width="70%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/2.gif")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. GWAS multi-fenótipo para os 281 fenótipos hiperespectrais sob manejo B+.
</p>

---
class: animate__animated, animate__fadeIn
# Câmera Termal na Identificação de Doenças
```{r, echo=FALSE, out.width="100%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/758CFDF0-42F4-4FEB-ACC0-44973111C347.JPG")
```

---
class: animate__animated, animate__fadeIn
# Câmera Termal na Identificação de Doenças
```{r, echo=FALSE, out.width="120%",fig.cap="", fig.align="center"}
knitr::include_graphics("figs/plot_temp.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. GWAS multi-fenótipo para os 281 fenótipos hiperespectrais sob manejo B+.
</p>


---
class: animate__animated, animate__fadeIn, inverse, center, middle

# Fatores que Influenciam a Acurácia, Aplicações e Limitações da Metodologia

---
class: animate__animated, animate__fadeIn

# Geração de Ortomosaicos Utilizando Imagens com Resolução Limitada

```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("figs/problem/Screen Shot 2022-01-05 at 9.05.27 PM.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Diversas tentativas de montagem de ortomosaico e junção (stitching) com imagens termais.
</p>
---
class: animate__animated, animate__fadeIn

# HTP challenges
```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("figs/problem/1.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Representação de diferentes shapefiles.
</p>

---
class: animate__animated, animate__fadeIn

# Geração de Shapefiles e Delimitação das Parcelas
```{r, echo=FALSE, out.width="199%", fig.align="center"}
knitr::include_graphics("figs/problem/2.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Representação de diferentes shapefiles.
</p>
---
class: animate__animated, animate__fadeIn

# Geração de Shapefiles e Delimitação das Parcelas
```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("figs/problem/3.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Representação de diferentes shapefiles.
</p>

---
class: animate__animated, animate__fadeIn

# Geração de Shapefiles e Delimitação das Parcelas
```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("figs/problem/4.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Representação de diferentes shapefiles.
</p>

---
class: animate__animated, animate__fadeIn

# Geração de Shapefiles e Delimitação das Parcelas
```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("figs/problem/4.png")
```
<p style="font-family: times, serif; font-size:11pt; font-style:italic">
Figura. Representação de diferentes shapefiles.
</p>

---
class: animate__animated, animate__fadeIn

#  Fatores que Impactam a Acurácia da Fenotipagem de Alto Rendimento

<div style="transform: scale(0.75); transform-origin: top center;">

| **Fator**                       | **Descrição**                                                             |
| :------------------------------ | :------------------------------------------------------------------------ |
| **Qualidade do Sensor**          | Sensores de maior resolução capturam dados mais detalhados                 |
| **Condições Ambientais**         | Clima, iluminação e variações de temperatura afetam a acurácia             |
| **Diversidade Fenotípica**       | Maior variabilidade genética das plantas pode gerar medições mais complexas |
| **Processamento de Dados**       | Qualidade do filtro, normalização e algoritmos de análise dos dados        |
| **Calibração**                   | Calibração adequada dos sensores garante consistência e reduz erros        |
| **Densidade de Amostragem**      | Amostragens mais frequentes melhoram a resolução temporal                  |
| **Fusão de Dados**               | Combinar múltiplos tipos de sensores aumenta a acurácia na detecção de traits |
| **Estabilidade da Plataforma**   | Plataformas fixas geram dados mais consistentes e confiáveis               |
| **Experiência do Usuário**       | Conhecimento sobre operação e interpretação influencia a confiabilidade    |


---
class: animate__animated, animate__fadeIn

# Desafios Atuais

<div style="transform: scale(0.70); transform-origin: top left; overflow: auto;width: 150%; height: 100%">

| **Tipo de Desafio**        | **Desafios Técnicos**                                       | **Desafios Biológicos**                                    |
| :------------------------- | :--------------------------------------------------------- | :-------------------------------------------------------- |
| **Altos Custos**           | Equipamentos caros, especialmente sensores avançados       | Tornar os sensores mais acessíveis para uso amplo         |
| **Armazenamento de Dados** | Grandes volumes de dados exigem armazenamento e processamento robustos | Transformar dados em informações úteis para o melhoramento genético |
| **Calibração**             | Dificuldades de calibração de sensores devido a variáveis ambientais | Padronizar traits biológicos em espécies vegetais diversas |
| **Acurácia**               | Variação no desempenho dos sensores em diferentes condições ambientais | A variabilidade biológica entre espécies pode afetar a consistência dos dados |
| **Integração de Dados**    | Dificuldade em integrar dados de múltiplos tipos de sensores | Combinar dados fenotípicos e genéticos para melhores predições |
| **Análise em Tempo Real**  | Necessidade de processar grandes volumes de dados em tempo real | Complexidade de analisar processos biológicos dinâmicos em tempo real |
| **Limitações da Plataforma** | Restrições de mobilidade e acessibilidade das plataformas | Adaptação dos métodos de fenotipagem para diferentes culturas e estágios de crescimento |
| **Escalabilidade**         | Dificuldade em escalar HTP para grandes áreas ou múltiplas espécies | Garantir relevância biológica em larga escala em ecossistemas diversos |
| **Integração ao Melhoramento** | Definir estratégias de melhoramento para correlação moderada com o trait-alvo |                                                          |

---

class: animate__animated, animate__fadeIn

<br /> <br /> <br /> <br /> <br /> <br />
#.center[Muito obrigado! ]

.right[[rafael.yassue@gmail.com](mailto:rafael.yassue@gmail.com?subject=%20Presentation)]
.right[https://rafaelyassue.github.io/cv-online/]
```{r, echo=FALSE, out.width="50%",fig.cap="", fig.align="right"}
knitr::include_graphics("figs/site2.png")
```

